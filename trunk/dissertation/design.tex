\chapter{Design}

\TODO{READ THIS AGAIN}
In this section a set of concepts and solutions is introduced in order to solve the problems faced
by the implementation of this project.


% ---------------------------------------


\section{Concepts}


\subsection{Building}

A \emph{building} should be defined by its overall box shape.
Its purpose shall then be chosen, generating a building
with a given facade color and material properties and
its facade components.

One can then define an office building by setting its dimensions
and purpose, letting the system generate the facade details.


\subsection{Architecture Style}

The process of facade generation is based on a chosen style,
picked by the user from a set of available \emph{architecture styles}.
Those styles define the facade color theme, material, roof type and 
a short grammar allowing a way to set the odds of different facade details appearing
at different floors.
Architecture styles are defined a priori, in an orderly manner.
At the system one can only make use the previously defined styles.

\TODO{ADD FIGURE OF BUILDING VOLUME AND ANOTHER ONE WITH THE GENERATED BUILDING}


\subsection{Facade Attachment}

A \emph{facade attachment} is a physical feature placed on a facade.
Examples of this are windows, doors and balconies.
A facade attachment has a fixed shape, i.e. one that can't be edited.

Once a building is populated of facade attachments,
the user can customize the obtained result
by replacing, adding or deleting attachments.

If other features are required for the building,
additional shapes can be summoned.


\subsection{Template Shape}

A \emph{template shape} is one which has modifiable properties.
Unlike facade attachments, the form of template shapes
is not fixed, but follows a recipe for its generation,
based on the values assigned to its properties.
The most basic template shape allows altering its dimensions.
More complex template shapes offer additional properties.

An example of a template shape is linear stairs.
Besides their dimensions, one can change the number of steps and
whether the stairs have solid casing or are made of discrete structures.


\TODO{INSERT STAIR EXAMPLE HERE}


\subsection{Custom Shape}

\emph{Custom shapes} can also be defined when no alternative is viable.
Those can have their volume modeled by a set of modeling operations
supported by the system.
Custom shapes are useful to provide a way of representing
specific features to facades, such as a porch or an original window frame.

The creation of both architectural styles and facade attachments,
although not available inside the program, should be a simple process,
supported by a set of tools, providing an alternative work flow for new
content generation.

% ---------------------------------------


\section{Supported Tasks}

Means should be given for users to import a basic approximation of the
city's geographical features, such as the most notable geological formations,
road blocks, green areas, etc.
This defines the working ``canvas'' of the city scenery.
It is on top of this that buildings and their features can be placed, edited and reviewed.


\subsection{Scene Navigation}

Navigation modes should be provided so the user manages
to move throughout the complexity of the city environment.
There may be several, depending on the task at hand.

One might prefer to walk through the scene to get the feeling of the citizen's perspective,
going forward or turning sideways and looking up to see the buildings.

If an editing operation is being performed on a subject, the attention should be focused on it,
therefore the navigation model should allow getting closer or farther away from it and dollying around it.

Occasionally one needs to get the overall look at a city block, examine different areas for congruence
or show the scenery to another user. These times a continuous, non-intrusive way of navigation should be provided,
allowing easy hovering the city features.


\subsection{Building Creation}

Buildings should be easily created, based or their volume and purpose.
Once created they could have their features edited.
The generation of city blocks should be aided by supporting building replication.


\subsection{Scene Reviewing}

Means must be given for users to take notes on features they're not pleased with.
A note should allow free expression of its contents and should remain attach to the
subject of critic, so the remaining people can undoubtedly understand the subject
the note is about and either take measures about it or answer the posted content.


% ---------------------------------------


\section{User Interface}

\subsection{The Gate Concept}
\label{sec:gate-concept}

The most common selection action in nowadays computer interactions works by
pressing a button on the interface with the mouse, trackball or similar pointing devices.

Given the hardware at hand for the projected scenarios,
users will be handling either a computer pen for using the tablet PC or a laser pointer for using the power wall.

Using such devices, the clicking action can not be accurately detected.
The author and the remaining team behind the multimedia lab have read about this problem and analyzed proposed alternatives {TODO: AQUELE ARTIGO DAS GATES MANHOSAS},
coming up with a novel interface concept, akin to this article but with different capabilities: the \emph{gate} concept.

A gate is a two dimensional area delimited by two imaginary lines. To activate the desired behavior associated
with it one has to cross the space between the lines, hence the gate name.

\TODO{INSERT GATE IMAGES AND MORE CONTENT}

\subsubsection{Circular Menus}

\TODO{...}

\subsection{Navigation}

Some of the navigation modes require custom widgets in order to be effective.

\subsubsection{Bird's Eye View Mode}
\label{sec:bev}

This widget has two different areas.
The central circle displays the top-down view of the scene, with the user occupying the middle of the map.
Around it, an outer ring displays the cardinal points, resembling a compass.

These areas provide not only information about the user's position and orientation but also means of
modifying those parameters by direct manipulation.

\TODO{INSERT BEV ILLUSTRATION}

The central region can be dragged, allowing the user to identify a destination by looking at the map and
panning towards it.

The outer ring allows reading the current cardinal orientation,
identifying the orientation of nearby subjects by cross-checking the two areas and
modifying the user orientation to a specific cardinal point or any discrete value between them.


\subsubsection{Examine Navigation Mode}
\label{sec:examine}

When editing a property or shape of a subject, it's useful to have a simple and effective way
of repositioning oneself to get a different perspective, keeping the subject as the center of the view.

\TODO{EXAMINE ILLUSTRATION}

This widget features a wire frame sphere at the center and two zooming gates.
The sphere serves as a subject for direct manipulation of the orientation change around the subject of examining.
It supports dragging, mimicking the sphere rotation by rotating around the target object.
Moving closer or farther away from the object is provided by activating the zooming gates.


\subsubsection{Dial Number Input}

Since there is no keyboard projected in use with the system, a way must be offered to select a number.
This poses itself necessary in the configuration of template shapes' properties.
The idea here is to have the current state of the widget displayed clearly at the center of the widget
and support the rotation gesture around it as a mean of changing the associated value.

\TODO{ADD DIAL ILLUSTRATION}

The direction of rotation sets the sign the applied change, that is, clockwise rotations increment
the value and counterclockwise rotations decrement it.

The amplitude of the applied rotation sets the increment itself -- a short rotation changes the value
slightly while a longer one originates a bigger change.

With such interface both discrete and continuous values can be supported, by making use of the speed of rotation.
While applying faster rotation changes between larger values (ex: 2, 3, 4, 5...), applying slower rotating
gestures displays more detailed output (ex: 2.31, 2.32, 2.33...).

This concept can be easily generalized to sets of options, with the user walking along the list with the rotation gestures.


\subsubsection{Load / Save Input}

\TODO{SEE IF TEXT APPLIES AND ADD ILLUSTRATION}

Users might want to save a custom made shape or building. Due to the absence of keyboard, the saved object
saves along with it the creation time information and a screen shot.
Later on, when performing the load operation, a list of screen shots gets displayed, ordered from the most
recent save to the least recent one.

This allows the inspection of the latests saves, ordered somewhat like a time-line. One could identify the
desired save by correlating the times or by recognizing the annexed screen shot.

\TODO{...}
